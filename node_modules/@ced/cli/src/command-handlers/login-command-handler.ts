import { AuthService } from "../services/auth.service";

export class LoginCommandHandler {

  private _authService: AuthService;

  public constructor() {
    this._authService = new AuthService();
  }

  public async run(headlessMode: boolean) {
    const requestToken = await this._authService.startLogin();
    console.log('  Waiting for login...');
    const token = await this._authService.waitForToken(requestToken);
    console.log('  Login completed.');

    if (headlessMode) {
      console.log();
      console.log('  Token: ' + token);
    } else {
      this._authService.setTokens(requestToken, token);
    }

    console.log();
  }
}