import * as axios from 'axios'
import { config } from '../config/config';
import { AuthService } from './auth.service';

export class SecurityService {

  public constructor(private _token?: string) {
  }

  public async getFirebaseToken(projectId: string): Promise<string> {
    const authService = new AuthService();
    const token = authService.getTokenOrThrow(this._token);
    const url = `${config.serverBaseUrl}/security/firebase-token?projectId=${projectId}`;
    const response = await axios.default.get(url, {
      headers: {
        "cli-token": token,
      }
    });
    return response.data.firebaseToken;
  }

  public async getSession(): Promise<any> {
    const authService = new AuthService();
    const token = authService.getTokenOrThrow(this._token);
    const url = `${config.serverBaseUrl}/security/current-session`;
    const response = await axios.default.get(url, {
      headers: {
        "cli-token": token,
      }
    });
    return response.data;
  }
}