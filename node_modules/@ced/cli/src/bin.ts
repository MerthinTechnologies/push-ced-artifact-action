#!/usr/bin/env node
import * as program from 'commander';
import { config } from './config/config';
import { GlobalErrorHandler } from './services/global-error-handler.service';
import { LoginCommand } from './commands/login-command';
import { LogoutCommand } from './commands/logout.command';
import { PushCommand } from './commands/push.command';
import { CreateVersionCommand } from './commands/create-version.command';
import { ContextCommand } from './commands/context.command';
import { InitCommand } from './commands/init.command';
import { ProjectsCommand } from './commands/projects.command';
import { SessionCommand } from './commands/session.command';
import { UpdaterService } from './services/updater.service';

GlobalErrorHandler.init();
UpdaterService.notifyAvailableUpdate();

program
  .version(config.version)
  .option('-t, --token <Token>', `Pre authenticated token.`)  
  .description(`CloudEdgeDistribution command line interface`);

InitCommand.install();
LoginCommand.install();
LogoutCommand.install();
SessionCommand.install();
ContextCommand.install();
CreateVersionCommand.install();
PushCommand.install();
ProjectsCommand.install();

if (process.argv.length === 2) {
  program.outputHelp();
} else {
  program.parse(process.argv);
}
