"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const chalk = require("chalk");
const version_service_1 = require("../services/version.service");
const project_directory_config_service_1 = require("../services/project-directory-config.service");
class CreateVersionCommandHandler {
    constructor(token) {
        this._configService = new project_directory_config_service_1.ProjectDirectoryConfigService();
        this._versionService = new version_service_1.VersionService(token);
    }
    async run(environment, rawOutput) {
        const context = this._configService.get();
        ;
        return await this._createVersion(context.projectId, environment || context.defaultEnvironment, context.subsystemId, rawOutput);
    }
    async _createVersion(projectId, environment, subsystemId, rawOutput) {
        const version = await this._versionService.create(projectId, environment, subsystemId);
        const message = rawOutput
            ? version.name
            : 'Version created: ' + chalk.cyan(version.name);
        console.log(message);
        if (!rawOutput) {
            console.log();
        }
        return version.name;
    }
}
exports.CreateVersionCommandHandler = CreateVersionCommandHandler;
//# sourceMappingURL=create-version-command-handler.js.map